"use strict";function carte(o){$(".map").prepend('<div id="map"></div>');var i=L.map("map",{center:[o.coord.lat,o.coord.lon],zoom:8});L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(i),L.marker([o.coord.lat,o.coord.lon]).addTo(i).bindPopup(o.name).openPopup()}var box=$("#InnerBox"),nom=$("#ville");$.ajax({url:"https://vicopo.selfbuild.fr/ville/cahors",type:"GET",dataType:"json"}).done(function(o){$("#ville").keydown(function(o){if(13==o.keyCode){var i=$(this);$.vicopo(i.val(),function(o,e){o==i.val()&&e[0]&&i.val(e[0].city).vicopoTarges().vicopoClean()}),o.preventDefault(),o.stopPropagation()}})}).fail(function(o){console.log(o)}).always(function(){}),$("#selec").click(function(){$("#map").remove(),$.ajax({url:"http://api.openweathermap.org/data/2.5/weather?q="+nom.val()+",fr&appid=2304ca0a4c5b96eca86deb93757adbfa",type:"GET",dataType:"json"}).done(function(o){box.html("<ul><li><b>Ville:</b> "+o.name+"</li><li><b>Longitude:</b> "+o.coord.lon+"</li><li><b>Lattitude:</b> "+o.coord.lat+"</li><li><b>Vent:</b> "+o.wind.speed+" Km/h </li><li><b>Taux d'humidité:</b> "+o.main.humidity+"</li><li><b>Pression:</b> "+o.main.pressure+"</li><li><b>Température:</b> "+(o.main.temp-273.15).toFixed(2)+" °C</li><li><b>Température Min:</b> "+(o.main.temp_min-273.15).toFixed(2)+" °C</li><li><b>Température Max:</b> "+(o.main.temp_max-273.15).toFixed(2)+" °C</li></ul>"),carte(o)}).fail(function(o){console.log(o),box.html(""),alert("Ville introuvable !")}).always(function(o){})});